{
  "version": "1.9.0", 
  "nickname": "ModelToTHMZ", 
  "outputs": [
    [
      {
        "access": "None", 
        "name": "thmz", 
        "description": "The file path of the SQL result file that has been generated on this\ncomputer. This will be None unless run_ is set to True.", 
        "type": null, 
        "default": null
      }
    ]
  ], 
  "inputs": [
    {
      "access": "item", 
      "name": "_model", 
      "description": "A fairyfly model object possessing all geometry and therm\nsimulation properties.", 
      "type": "System.Object", 
      "default": null
    }, 
    {
      "access": "item", 
      "name": "_folder_", 
      "description": "An optional folder on this computer, into which the THMZ file\nwill be written.", 
      "type": "string", 
      "default": null
    }, 
    {
      "access": "item", 
      "name": "_write", 
      "description": "Set to \"True\" to write the THMZ file from the fairyfly Model.", 
      "type": "bool", 
      "default": null
    }, 
    {
      "access": "item", 
      "name": "run_", 
      "description": "Set to \"True\" to simulate the THMZ file in THERM once it is written.\nThis will ensure that results are embedded within the output\nTHMZ file such that they can be visualized with the\n\"FF Read THERM Result\" component.\n_\nThis input can also be the integer \"2\", which will run the whole\ntranslation and simulation silently (without any batch windows).", 
      "type": "int", 
      "default": null
    }
  ], 
  "subcategory": "1 :: THERM", 
  "code": "\nimport os\n\ntry:\n    from fairyfly.config import folders\n    from fairyfly.typing import clean_string\n    from fairyfly.model import Model\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import fairyfly:\\n\\t{}'.format(e))\n\ntry:\n    from fairyfly_therm.config import folders as therm_folders\n    from fairyfly_therm.writer import model_to_thmz\n    from fairyfly_therm.run import run_model\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import fairyfly_energy:\\n\\t{}'.format(e))\n\ntry:\n    from ladybug_{{cad}}.{{plugin}} import all_required_inputs, give_warning\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import ladybug_{{cad}}:\\n\\t{}'.format(e))\n\n\nif all_required_inputs(ghenv.Component) and _write:\n    # check the presence of openstudio and check that the version is compatible\n    therm_folders.check_therm_version()\n    assert isinstance(_model, Model), \\\n        'Expected Fairyfly Model for _model input. Got {}.'.format(type(_model))\n\n    # process the simulation folder name\n    model_name = clean_string(_model.display_name)\n    _folder_ = os.path.join(folders.default_simulation_folder, model_name) \\\n        if _folder_ is None else _folder_\n\n    # write the model to THMZ or run it through THERM\n    if not run_:\n        thmz = os.path.join(_folder_, '{}.thmz'.format(model_name))\n        model_to_thmz(_model, thmz)\n    else:\n        silent = True if run_ > 1 else False\n        thmz = run_model(_model, _folder_, silent)\n", 
  "category": "Fairyfly", 
  "name": "FF Model to THMZ", 
  "description": "Write a fairyfly Model to an THMZ file (aka. THERM Zip file), which can then be\nsimulated or opened in the THERM interface.\n-"
}