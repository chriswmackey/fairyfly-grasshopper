{
  "version": "1.9.4", 
  "nickname": "ThermResult", 
  "outputs": [
    [
      {
        "access": "None", 
        "name": "shape_geo", 
        "description": "A list of breps for the geometry of the Shapes contained within\nthe THMZ file. The edges of these shapes can be used to overlay\nwireframe visualizations on top of the result mesh.", 
        "type": null, 
        "default": null
      }, 
      {
        "access": "None", 
        "name": "points", 
        "description": "The grid of points representing the nodes of the mesh generated by THERM.", 
        "type": null, 
        "default": null
      }, 
      {
        "access": "None", 
        "name": "results", 
        "description": "A list of numbers that aligns with the points. Each number indicates\nthe temeprature (or heat flux) at each of the points.", 
        "type": null, 
        "default": null
      }, 
      {
        "access": "None", 
        "name": "mesh", 
        "description": "A colored mesh produced from the model's shapes representing the\ntemperature or heat flow through the construction.", 
        "type": null, 
        "default": null
      }, 
      {
        "access": "None", 
        "name": "legend", 
        "description": "A legend showing the values that correspond to the colors of the mesh.", 
        "type": null, 
        "default": null
      }, 
      {
        "access": "None", 
        "name": "title", 
        "description": "A text object for the study title.", 
        "type": null, 
        "default": null
      }, 
      {
        "access": "None", 
        "name": "vis_set", 
        "description": "A VisualizationSet object for drawing a detailed version of the\nTherm results in the Rhino scene. This can be connected to\nthe \"LB Preview Visualization Set\" component to display this\nversion of the results in Rhino.", 
        "type": null, 
        "default": null
      }
    ]
  ], 
  "inputs": [
    {
      "access": "item", 
      "name": "_thmz", 
      "description": "Path to a THMZ file that has been simulated in THERM. This can be the\ndirect output of the \"FF Model to THMZ\" component as long as\nrun_ has been set to True.", 
      "type": "string", 
      "default": null
    }, 
    {
      "access": "item", 
      "name": "_data_type_", 
      "description": "Optional text or an integer to set the type of result data to import from\nthe THMZ file. Choose from the following options. (Default: Temperature)\n0 - Temperature (C or F)\n1 - Heat Flux (W/m2 or Btu/h-ft2)", 
      "type": "string", 
      "default": null
    }, 
    {
      "access": "item", 
      "name": "ip_", 
      "description": "Set to True to have all data imported with IP Units (Farenheit and Btu/h-ft2)\ninstead of the default SI units of Celsius and W/m2.", 
      "type": "bool", 
      "default": null
    }, 
    {
      "access": "item", 
      "name": "legend_par_", 
      "description": "Optional legend parameters from the \"LB Legend Parameters\"\nthat will be used to customize the display of the results.", 
      "type": "System.Object", 
      "default": null
    }
  ], 
  "subcategory": "1 :: THERM", 
  "code": "\ntry:  # import the core fairyfly dependencies\n    from fairyfly_therm.result import THMZResult\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import fairyfly:\\n\\t{}'.format(e))\n\ntry:  # import the core ladybug dependencies\n    from ladybug.graphic import GraphicContainer\n    from ladybug.legend import LegendParameters\n    from ladybug.color import Colorset\n    from ladybug.datatype.temperature import Temperature\n    from ladybug.datatype.energyflux import EnergyFlux\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import ladybug:\\n\\t{}'.format(e))\n\ntry:\n    from ladybug_display.visualization import VisualizationSet\n    from ladybug_display.context import ContextGeometry\n    from ladybug_display.geometry3d import DisplayLineSegment3D\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import ladybug:\\n\\t{}'.format(e))\n\ntry:  # import the ladybug_{{cad}} dependencies\n    from ladybug_{{cad}}.config import conversion_to_meters\n    from ladybug_{{cad}}.fromgeometry import from_mesh3d, from_point3d, from_face3d\n    from ladybug_{{cad}}.fromobjects import legend_objects\n    from ladybug_{{cad}}.text import text_objects\n    from ladybug_{{cad}}.{{plugin}} import all_required_inputs, give_warning, \\\n        hide_output, show_output\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import ladybug_{{cad}}:\\n\\t{}'.format(e))\n\nDATA_TYPES = {\n    'none': 'temperatures',\n    'temperature': 'temperatures',\n    '0': 'temperatures',\n    'heat flux': 'heat_flux_magnitudes',\n    '1': 'heat_flux_magnitudes'\n}\n\n\nif all_required_inputs(ghenv.Component):\n    # create the THMZResult object and check to be sure that it has been simulated\n    result_obj = THMZResult(_thmz)\n    study_mesh = result_obj.mesh\n    conversion = 0.001 / conversion_to_meters()\n    shape_geo = result_obj.shape_faces\n    shape_geo = [f.scale(conversion) for f in shape_geo]\n    if study_mesh is None:\n        msg = 'No mesh was found within the THMZ file.\\nMake sure that the THMZ ' \\\n            'file has been successfully simulated in THERM.'\n        print(msg)\n        give_warning(ghenv.Component, msg)\n\n    else:\n        # scale the mesh to the current {{Cad}} model units\n        study_mesh = study_mesh.scale(conversion)\n        # get the results from the THMZ file\n        data_attr = DATA_TYPES[str(_data_type_).lower()]\n        results = getattr(result_obj, data_attr)\n        if results is None:\n            msg = 'No steady state results were found within the THMZ file.\\n' \\\n                'Make sure that the THMZ has been set up for steady state simulation ' \\\n                'and has been successfully simulated in THERM.'\n            print(msg)\n            give_warning(ghenv.Component, msg)\n        else:\n            # process the results into the correct units\n            if data_attr == 'temperatures':\n                units = 'F' if ip_ else 'C'\n                study_name = 'Temperature [{}]'.format(units)\n                if ip_:\n                    results = Temperature().to_ip(results, 'C')[0]\n            else:\n                units = 'Btu/h-ft2' if ip_ else 'W/m2'\n                study_name = 'Heat Flux [{}]'.format(units)\n                if ip_:\n                    results = EnergyFlux().to_ip(results, 'W/m2')[0]\n\n            # # create the mesh and legend outputs\n            l_par = legend_par_ if legend_par_ is not None else LegendParameters()\n            if l_par.are_colors_default:\n                l_par.colors = Colorset.therm()\n            graphic = GraphicContainer(results, study_mesh.min, study_mesh.max, l_par)\n            graphic.legend_parameters.title = units\n            title = text_objects(\n                study_name, graphic.lower_title_location,\n                graphic.legend_parameters.text_height * 1.5,\n                graphic.legend_parameters.font)\n\n            # create the visual outputs\n            study_mesh.colors = graphic.value_colors\n            legend = legend_objects(graphic.legend)\n            # create the VisualizationSet\n            vis_set = VisualizationSet.from_single_analysis_geo(\n                'Therm_Results', [study_mesh], results, graphic.legend_parameters)\n            wireframe = []\n            for face3d in shape_geo:\n                for seg in face3d.boundary_segments:\n                    wireframe.append(DisplayLineSegment3D(seg, line_width=2))\n                if face3d.has_holes:\n                    for hole in face3d.hole_segments:\n                        for seg in hole:\n                            wireframe.append(DisplayLineSegment3D(seg, line_width=2))\n            con_outline = ContextGeometry('Wireframe', wireframe)\n            vis_set.add_geometry(con_outline)\n\n        # create the visual outputs\n        points = [from_point3d(pt) for pt in study_mesh.vertices]\n        mesh = from_mesh3d(study_mesh)\n\n    # hide the points and shapes from the scene\n    shape_geo = [from_face3d(f) for f in shape_geo]\n    hide_output(ghenv.Component, 1)\n    hide_output(ghenv.Component, 2)\n", 
  "category": "Fairyfly", 
  "name": "FF Read THERM Result", 
  "description": "Create Fairyfly Boundary.\n-"
}